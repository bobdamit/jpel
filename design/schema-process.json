{
  "type": "object",
  "required": [
    "id",
    "name",
    "start",
    "activities"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique process identifier"
    },
    "name": {
      "type": "string",
      "description": "Human-readable process name"
    },
    "description": {
      "type": "string",
      "description": "Process description"
    },
    "version": {
      "type": "string",
      "description": "Process version"
    },
    "variables": {
      "type": "array",
      "description": "Process-level variables",
      "items": {
        "type": "object",
        "required": [
          "name",
          "type"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Variable name"
          },
          "type": {
            "type": "string",
            "enum": [
              "text",
              "number",
              "boolean",
              "select",
              "date",
              "file",
              "string"
            ],
            "description": "Variable type"
          },
          "defaultValue": {
            "description": "Default value"
          },
          "description": {
            "type": "string",
            "description": "Variable description"
          },
          "label": {
            "type": "string",
            "description": "Optional human-friendly label for UIs"
          },
          "hint": {
            "type": "string",
            "description": "Optional hint/help text for UIs (e.g., tooltip)"
          },
          "value": {
            "description": "Runtime value of the variable (type depends on `type`)"
          },
          "required": {
            "type": "boolean",
            "description": "Whether the variable is required",
            "default": false
          },
          "options": {
            "type": "array",
            "description": "Options for select fields as label/value pairs",
            "items": {
              "type": "object",
              "required": [
                "value"
              ],
              "properties": {
                "label": {
                  "type": "string",
                  "description": "Optional human-friendly label for the option"
                },
                "value": {
                  "description": "Option value (may be string, number or boolean)",
                  "oneOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "boolean"
                    }
                  ]
                }
              }
            }
          },
          "min": {
            "type": "number",
            "description": "Minimum value (for numbers)"
          },
          "max": {
            "type": "number",
            "description": "Maximum value (for numbers)"
          },
          "units": {
            "type": "string",
            "description": "Units of measurement"
          },
          "pattern": {
            "type": "string",
            "description": "Regular expression pattern for validation"
          },
          "patternDescription": {
            "type": "string",
            "description": "Human-readable description of the pattern requirements"
          }
        },
        "additionalProperties": false
      }
    },
    "start": {
      "type": "string",
      "description": "Initial activity reference"
    },
    "activities": {
      "type": "object",
      "description": "Map of activity definitions",
      "additionalProperties": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique activity identifier"
          },
          "name": {
            "type": "string",
            "description": "Human-readable activity name"
          },
          "description": {
            "type": "string",
            "description": "Activity description"
          },
          "type": {
            "type": "string"
          },
          "timeout": {
            "type": "integer",
            "description": "Activity timeout in seconds"
          }
        }
      }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "Variable": {
      "type": "object",
      "required": [
        "name",
        "type"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Variable name"
        },
        "type": {
          "type": "string",
          "enum": [
            "text",
            "number",
            "boolean",
            "select",
            "date",
            "file",
            "string"
          ],
          "description": "Variable type"
        },
        "defaultValue": {
          "description": "Default value"
        },
        "description": {
          "type": "string",
          "description": "Variable description"
        },
        "label": {
          "type": "string",
          "description": "Optional human-friendly label for UIs"
        },
        "hint": {
          "type": "string",
          "description": "Optional hint/help text for UIs (e.g., tooltip)"
        },
        "value": {
          "description": "Runtime value of the variable (type depends on `type`)"
        },
        "required": {
          "type": "boolean",
          "description": "Whether the variable is required",
          "default": false
        },
        "options": {
          "type": "array",
          "description": "Options for select fields as label/value pairs",
          "items": {
            "type": "object",
            "required": [
              "value"
            ],
            "properties": {
              "label": {
                "type": "string",
                "description": "Optional human-friendly label for the option"
              },
              "value": {
                "description": "Option value (may be string, number or boolean)",
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "number"
                  },
                  {
                    "type": "boolean"
                  }
                ]
              }
            }
          }
        },
        "min": {
          "type": "number",
          "description": "Minimum value (for numbers)"
        },
        "max": {
          "type": "number",
          "description": "Maximum value (for numbers)"
        },
        "units": {
          "type": "string",
          "description": "Units of measurement"
        },
        "pattern": {
          "type": "string",
          "description": "Regular expression pattern for validation"
        },
        "patternDescription": {
          "type": "string",
          "description": "Human-readable description of the pattern requirements"
        }
      },
      "additionalProperties": false
    },
    "Activity": {
      "type": "object",
      "required": [
        "type"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique activity identifier"
        },
        "name": {
          "type": "string",
          "description": "Human-readable activity name"
        },
        "description": {
          "type": "string",
          "description": "Activity description"
        },
        "type": {
          "type": "string"
        },
        "timeout": {
          "type": "integer",
          "description": "Activity timeout in seconds"
        }
      }
    },
    "HumanActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "human"
            },
            "prompt": {
              "type": "string",
              "description": "Prompt shown to user"
            },
            "inputs": {
              "type": "array",
              "description": "Input fields for user",
              "items": {
                "type": "object",
                "required": [
                  "name",
                  "type"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Field identifier"
                  },
                  "label": {
                    "type": "string",
                    "description": "Optional human-friendly label shown in the UI"
                  },
                  "hint": {
                    "type": "string",
                    "description": "Optional hint or tooltip text for the field"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "text",
                      "number",
                      "boolean",
                      "select",
                      "date",
                      "file"
                    ],
                    "description": "Input field type"
                  },
                  "required": {
                    "type": "boolean",
                    "description": "Whether field is required",
                    "default": false
                  },
                  "options": {
                    "type": "array",
                    "description": "Options for select fields",
                    "items": {
                      "type": "object",
                      "required": [
                        "value"
                      ],
                      "properties": {
                        "label": {
                          "type": "string",
                          "description": "Optional human-friendly label for the option"
                        },
                        "value": {
                          "description": "Option value (may be string, number or boolean)",
                          "oneOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "boolean"
                            }
                          ]
                        }
                      }
                    }
                  },
                  "min": {
                    "type": "number",
                    "description": "Minimum value (for numbers)"
                  },
                  "max": {
                    "type": "number",
                    "description": "Maximum value (for numbers)"
                  },
                  "units": {
                    "type": "string",
                    "description": "Units of measurement"
                  },
                  "defaultValue": {
                    "description": "Default field value"
                  },
                  "description": {
                    "type": "string",
                    "description": "Field description"
                  },
                  "pattern": {
                    "type": "string",
                    "description": "Regular expression pattern for validation"
                  },
                  "patternDescription": {
                    "type": "string",
                    "description": "Human-readable description of the pattern requirements"
                  }
                },
                "additionalProperties": false
              }
            },
            "fileUploads": {
              "type": "array",
              "description": "File upload specifications",
              "items": {
                "type": "object",
                "required": [
                  "name",
                  "allowedTypes",
                  "maxBytes"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Upload identifier"
                  },
                  "description": {
                    "type": "string",
                    "description": "Upload description"
                  },
                  "allowedTypes": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Allowed MIME types"
                  },
                  "maxBytes": {
                    "type": "integer",
                    "description": "Maximum file size in bytes"
                  },
                  "minCount": {
                    "type": "integer",
                    "description": "Minimum number of files",
                    "default": 1
                  },
                  "maxCount": {
                    "type": "integer",
                    "description": "Maximum number of files",
                    "default": 1
                  }
                }
              }
            },
            "attachments": {
              "type": "array",
              "description": "Reference attachments",
              "items": {
                "type": "object",
                "required": [
                  "name",
                  "url",
                  "mediaType"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Attachment name"
                  },
                  "url": {
                    "type": "string",
                    "description": "Attachment URL"
                  },
                  "mediaType": {
                    "type": "string",
                    "description": "MIME type"
                  },
                  "bytes": {
                    "type": "integer",
                    "description": "File size in bytes"
                  }
                }
              }
            }
          }
        }
      ]
    },
    "Field": {
      "type": "object",
      "required": [
        "name",
        "type"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Field identifier"
        },
        "label": {
          "type": "string",
          "description": "Optional human-friendly label shown in the UI"
        },
        "hint": {
          "type": "string",
          "description": "Optional hint or tooltip text for the field"
        },
        "type": {
          "type": "string",
          "enum": [
            "text",
            "number",
            "boolean",
            "select",
            "date",
            "file"
          ],
          "description": "Input field type"
        },
        "required": {
          "type": "boolean",
          "description": "Whether field is required",
          "default": false
        },
        "options": {
          "type": "array",
          "description": "Options for select fields",
          "items": {
            "type": "object",
            "required": [
              "value"
            ],
            "properties": {
              "label": {
                "type": "string",
                "description": "Optional human-friendly label for the option"
              },
              "value": {
                "description": "Option value (may be string, number or boolean)",
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "number"
                  },
                  {
                    "type": "boolean"
                  }
                ]
              }
            }
          }
        },
        "min": {
          "type": "number",
          "description": "Minimum value (for numbers)"
        },
        "max": {
          "type": "number",
          "description": "Maximum value (for numbers)"
        },
        "units": {
          "type": "string",
          "description": "Units of measurement"
        },
        "defaultValue": {
          "description": "Default field value"
        },
        "description": {
          "type": "string",
          "description": "Field description"
        },
        "pattern": {
          "type": "string",
          "description": "Regular expression pattern for validation"
        },
        "patternDescription": {
          "type": "string",
          "description": "Human-readable description of the pattern requirements"
        }
      },
      "additionalProperties": false
    },
    "ValueOption": {
      "type": "object",
      "required": [
        "value"
      ],
      "properties": {
        "label": {
          "type": "string",
          "description": "Optional human-friendly label for the option"
        },
        "value": {
          "description": "Option value (may be string, number or boolean)",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "number"
            },
            {
              "type": "boolean"
            }
          ]
        }
      }
    },
    "FileUpload": {
      "type": "object",
      "required": [
        "name",
        "allowedTypes",
        "maxBytes"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Upload identifier"
        },
        "description": {
          "type": "string",
          "description": "Upload description"
        },
        "allowedTypes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Allowed MIME types"
        },
        "maxBytes": {
          "type": "integer",
          "description": "Maximum file size in bytes"
        },
        "minCount": {
          "type": "integer",
          "description": "Minimum number of files",
          "default": 1
        },
        "maxCount": {
          "type": "integer",
          "description": "Maximum number of files",
          "default": 1
        }
      }
    },
    "Attachment": {
      "type": "object",
      "required": [
        "name",
        "url",
        "mediaType"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "Attachment name"
        },
        "url": {
          "type": "string",
          "description": "Attachment URL"
        },
        "mediaType": {
          "type": "string",
          "description": "MIME type"
        },
        "bytes": {
          "type": "integer",
          "description": "File size in bytes"
        }
      }
    },
    "APIActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "api"
            },
            "method": {
              "type": "string",
              "enum": [
                "GET",
                "POST",
                "PUT",
                "DELETE"
              ],
              "description": "HTTP method"
            },
            "url": {
              "type": "string",
              "description": "API endpoint URL"
            },
            "headers": {
              "type": "object",
              "description": "HTTP headers",
              "additionalProperties": {
                "type": "string"
              }
            },
            "queryParams": {
              "type": "object",
              "description": "Query parameters",
              "additionalProperties": {
                "type": "string"
              }
            },
            "body": {
              "description": "Request body",
              "type": "object"
            }
          }
        }
      ]
    },
    "ComputeActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "compute"
            },
            "code": {
              "type": "array",
              "description": "JavaScript code lines using JPEL variable syntax",
              "items": {
                "type": "string"
              }
            }
          }
        }
      ]
    },
    "SequenceActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "sequence"
            },
            "activities": {
              "type": "array",
              "description": "Activities to execute in order",
              "items": {
                "type": "string"
              }
            }
          }
        }
      ]
    },
    "ParallelActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "parallel"
            },
            "activities": {
              "type": "array",
              "description": "Activities to execute in parallel",
              "items": {
                "type": "string"
              }
            }
          }
        }
      ]
    },
    "BranchActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "required": [
            "condition",
            "then"
          ],
          "properties": {
            "type": {
              "const": "branch"
            },
            "condition": {
              "type": "string",
              "description": "JavaScript condition expression"
            },
            "then": {
              "type": "string",
              "description": "Activity to execute if condition is true"
            },
            "else": {
              "type": "string",
              "description": "Activity to execute if condition is false"
            }
          }
        }
      ]
    },
    "SwitchActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "required": [
            "expression",
            "cases"
          ],
          "properties": {
            "type": {
              "const": "switch"
            },
            "expression": {
              "type": "string",
              "description": "JavaScript expression to evaluate"
            },
            "cases": {
              "type": "object",
              "description": "Map of case values to activity references",
              "additionalProperties": {
                "type": "string"
              }
            },
            "default": {
              "type": "string",
              "description": "Default activity if no case matches"
            }
          }
        }
      ]
    },
    "TerminateActivity": {
      "allOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique activity identifier"
            },
            "name": {
              "type": "string",
              "description": "Human-readable activity name"
            },
            "description": {
              "type": "string",
              "description": "Activity description"
            },
            "type": {
              "type": "string"
            },
            "timeout": {
              "type": "integer",
              "description": "Activity timeout in seconds"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "const": "terminate"
            },
            "reason": {
              "type": "string",
              "description": "Termination reason"
            },
            "result": {
              "type": "string",
              "enum": [
                "success",
                "failure"
              ],
              "description": "Termination result",
              "default": "success"
            }
          }
        }
      ]
    }
  }
}